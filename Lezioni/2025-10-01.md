# Lezione 03
Nella lezione precedente abbiamo introdotto la classe dei **linguaggi regolari** (indicata con **$REG$**), definita come l'insieme di tutti i linguaggi per i quali esiste un Automa a Stati Finiti Deterministico in grado di riconoscerli.

I linguaggi regolari sono dotati di importanti proprietà: le proprietà di chiusura.
### Proprietà di Chiusura
##### Unione
###### Teorema - Chiusura rispetto all'unione
La classe dei linguaggi regolari $REG$ è chiusa rispetto all'operazione di unione.

**Idea:**
Intuizione: Siano $L_{1}$ e $L_{2}$ due linguaggi regolari, quindi:
$$\begin{gathered}L_{1}, L_{2}\in\text{REG}\implies\exists M_{1},M_{2}, \\\text{ tali che } L(M_{1})=L_{1} \text{ e }L(M_{2})=L_{2}\end{gathered}$$
Bisogna quindi definire un nuovo automa $M$ tale che $L(M)=L_{1}\cup L_{2}.$

Data una stringa di input $x$ il nuovo automa deve accettarla se $M_{1}$ la accetta oppure se $M_{2}$ la accetta.

L'idea di eseguire prima $M_{1}$ e poi $M_{2}$ sulla stessa stringa non è implementabile con un DFA. Il motivo fondamentale è che un DFA processa l'input in una singola passata, da sinistra a destra. 

Una volta letta l'intera stringa per essere testata su $M_{1}$ l'input è stato "consumato". L'automa non ha la capacità di "riavvolgere" l'input e ricominciare la lettura per $M_{2}$.

La soluzione quindi è di simulare $M_{1}$ e $M_{2}$ *in parallelo* e accettare se uno dei due accetta.

**Dimostrazione:**
Siano $$M_{1}=(Q_{1}, \Sigma, \delta_{1},q_{0}^{1},F_{1})$$e $$M_{2}=(Q_{2}, \Sigma, \delta_{2},q_{0}^{2},F_{2})$$
due DFA tali che $L(M_{1})=L_{1}$ e $L(M_{2})=L_{2}$.
(Per semplicità, assumiamo che l'alfabeto $\Sigma$ sia lo stesso per entrambi). L'obiettivo è quello di costruire un nuovo DFA $M=(Q,\Sigma,\delta,q_{0},F)$ tale che $L(M)=L_{1}\cup L_{2}$. 

Avremo:
- **Stati ($Q$):**
$$Q=\{(r_{1},r_{2}):r_{1}\in Q_{1}, r_{2}\in Q_{2} \} =Q_{1}\times Q_{2}$$
Gli stati di $M$ devono tenere traccia simultaneamente dello stato di $M_{1}$ e di $M_{2}$. Pertanto, ogni stato di $M$ sarà una coppia di stati, uno da $Q_{1}$ e uno da $Q_{2}$.
- **Stato iniziale ($q_{0})$:** 
$$q_{0}=(q_{0}^{1},q_{0}^{2})$$
All'inizio, entrambi gli automi si trovano nei rispettivi stati iniziali.
- **Funzione di Transizione $\delta$:**
$$\begin{gathered}\delta:Q \times \Sigma \longrightarrow Q \\ \delta((r_{1},r_{2}),a) = (\delta_{1}(r_{1},a),\delta_{2}(r_{2},a)) \end{gathered}$$
Quando $M$ legge un simbolo di input $a$, deve aggiornare lo stato di entrambi gli automi simulati, applicando le rispettive funzioni di transizione.
- **Stati di Accettazione $F$:**
$$\begin{gathered}F=\{(r_{1},r_{2}):r_{1},\in F_{1}\lor r_{2}\in F_{2} \} \end{gathered}$$
L'automa $M$ deve accettare una stringa se e solo se essa appartiene a $L_{1}$ oppure a $L_{2}$. Questo significa che la computazione parallela deve terminare in uno stato $(r_{1},r_{2})$ dove $r_{1}$ è uno stato finale di $M_{1}$ oppure $r_{2}$ è uno stato finale di $M_{2}$.
Questo può essere scritto in modo più compatto come 
$$F=(F_{1}\times Q_{2})\cup(Q_{1}\times F_{2})$$
Dove $F_{1}\times Q_{2}$ rappresenterà una coppia $(r_{1},r_{2})$, dove il primo stato sarà uno stato finale di $M_{1}$ mentre il secondo può essere un qualsiasi stato. Vale anche l'altro caso (stato finale $r_{2}$ di $M_{2}$ con un qualsiasi $r_{1}$)

**Correttezza:**
Per completare la prova bisogna dimostrare formalmente che $$L(M)=L_{1}\cup L_{2}.$$
Questo può essere fatto dimostrando per induzione la seguente proprietà:
$$\begin{gathered}\delta^{*}(q_{0},x)=\delta^{*}\Big((q_{0}^{1},q_{0}^{2}),x\Big) \\ = \Big(\delta^{*}_{1}(q_{0}^{1},x),\delta^{*}_{2}(q_{0}^{2},x)\Big)\end{gathered}\quad\forall x\in\Sigma^{*}$$
<font color="#000000"><span style="background:#affad1">La dimostrazione è stata data dal prof come esercizio.</span> <span style="background:#b1ffff">Svolgiamolo!</span></font>
La prima uguaglianza è vera per definizione di $q_{0}$. Dimostriamo la seconda:
- **Caso base:** Se $x=\mathcal{E}$
$$\begin{gathered}\delta^{*}\Big((q_{0}^{1},q_{0}^{2}),x\Big)=\delta^{*}\Big((q_{0}^{1},q_{0}^{2}),\mathcal{E}\Big)= \underline{(q_{0}^{1},q_{0}^{2})}\\\Big(\delta^{*}_{1}(q_{0}^{1},x),\delta^{*}_{2}(q_{0}^{2},x)\Big)=\Big(\delta^{*}_{1}(q_{0}^{1},\mathcal{E}),\delta^{*}_{2}(q_{0}^{2},\mathcal{E})\Big)=\underline{(q_{0}^{1},q_{0}^{2})} \end{gathered}$$
- **Ipotesi induttiva:** Sia la proprietà vera per un certo $w$ di lunghezza $n.$
$$\begin{gathered}\delta^{*}\Big((q_{0}^{1},q_{0}^{2}),w\Big)  = \Big(\delta^{*}_{1}(q_{0}^{1},w),\delta^{*}_{2}(q_{0}^{2},w)\Big)\end{gathered}$$
- **Caso Induttivo:** Bisogna ora dimostrare che è vero per una stringa $wa$ dove $a$ è il carattere che segue $w$ nell'input dell'automa.
$$\begin{gathered}\delta^{*}\Big((q_{0}^{1},q_{0}^{2}),wa\Big)  = \Big(\delta^{*}_{1}(q_{0}^{1},wa),\delta^{*}_{2}(q_{0}^{2},wa)\Big)\end{gathered}$$
Si noti che:
$$\begin{gathered}\delta^{*}\Big((q_{0}^{1},q_{0}^{2}),wa\Big)={\delta\Big(\underset{\text{Ipotesi Induttiva}}{\underbrace{\delta^{*}\big((q_0^{1},q_{0}^{2}),w\big)}},a\Big) }\\=\delta\Big(\big(\delta^{*}_{1}(q_{0}^{1},w),\delta^{*}_{2}(q_{0}^{2},w)\big),a\Big)\\ = \Big(\delta_{1}\big(\delta^{*}_{1}(q_{0}^{1},w),a\big),\delta_{2}\big(\delta^{*}_{2}(q_{0}^{2},w),a\big)\Big)\\ =(\delta^{*}_{1}(q_{0}^{1},wa),\delta^{*}_{2}(q_{0}^{2},wa))\end{gathered}$$
Dove l'ultima uguaglianza è vera per definizione di $\delta^{*}$.

---
Una volta dimostrato questo, la correttezza segue direttamente dalla definizione degli stati finali.
 $$\forall x\in \Sigma^{*}\qquad x\in L(M) \iff x\in L_{1}\cup L_{2}$$
Il **DFA** accetta $x$ se e solo se $x$ è nell'unione.
**Dimostrazione:**
- **$\implies:$**
Se $x\in L(M)$, allora vuol dire che l'automa $M$ accetta la stringa $x$, o meglio, una volta letto tutto $x$ l'automa si trova in uno stato di accettazione: $$\delta^{*}(q_{0},x)=\Big(\delta^{*}_{1}(q_{0}^{1},x),\delta^{*}_{2}(q_{0}^{2},x)\Big)\in F$$
dove $F=(F_{1}\times Q_{2})\cup (F_{2}\times Q_{1})$. 

Siccome la $\delta^{*}$ restituirà una coppia $(p,q)$ avremo che $p = \delta^{*}_{1}(q_{0}^{1},x)$ e $q=\delta^{*}_{2}(q_{0}^{2},x)$.

Se $\delta^{*}(q_{0},x)\in F$ vuol dire che $p\in F_{1}$ oppure $q\in F_{2}$, e questo significa che $x\in L_{1}$ oppure $x\in L_{2}\implies x\in L_{1}\cup L_{2.}$

- **$\Longleftarrow:$**
Se $x\in L_{1}$, avremo $\delta^{*}_{1}(q_{0}^{1},x)\in F_{1}$. Ma la $\delta^{*}$ è identificata dalla coppia
$$\delta^{*}(q_{0},x)=(\delta^{*}_{1}(q_{0}^{1},x),\delta^{*}_{2}(q_{0}^{2},x))\in F_{1}\times Q_{2}\subseteq F $$
e quindi $M$ accetta $x$.
Stessa cosa se $x\in L_{2}.\quad\blacksquare$

<font color="#000000"><span style="background:#affad1">Esercizio: Dimostrare che REG è chiusa per e per INTERSEZIONE e per COMPLEMENTO.</span> <span style="background:#b1ffff">Svolgiamoli!</span></font>
##### Intersezione
###### Teorema - Chiusura per Intersezione
Se anziché l'unione volessimo analizzare l'intersezione, dovremmo trovare un automa $M$ tale che, dati due linguaggi regolari $L_{1}$ e $L_{2}$: $$L(M)=L_{1}\cap L_{2}.$$
Per fare ciò, definiamo l'insieme degli stati finali $F$ come $F_{1}\times F_{2}$, ovvero l'insieme delle coppie $(r_{1},r_{2})$ dove $r_{1}$ è uno stato finale di $M_{1}$ e $r_{2}$ è uno stato finale di $M_{2}$.

**Dimostrazione:**
Dato che la differenza tra intersezione ed unione non sta nella funzione di transizione, ma negli stati finali, la prima parte della dimostrazione è identica a quella per dimostrare la chiusura dell'unione.
 
Dimostriamo quindi che
$$\forall x\in \Sigma^{*}\qquad x\in L(M) \iff x\in L_{1}\cap L_{2}$$
Il **DFA** accetta  se e solo se  è nell'intersezione.
**Dimostrazione:**
**$\implies:$**
Se $x\in L(M)$, allora vuol dire che l'automa $M$ accetta la stringa $x$, o meglio, una volta letto tutto $x$ l'automa si trova in uno stato di accettazione: $$\delta^{*}(q_{0},x)=\Big(\delta^{*}_{1}(q_{0}^{1},x),\delta^{*}_{2}(q_{0}^{2},x)\Big)\in F$$
dove $F=F_{1}\times F_{2}$. 

Siccome la $\delta^{*}$ restituirà una coppia $(p,q)$ avremo che $p = \delta^{*}_{1}(q_{0}^{1},x)$ e $q=\delta^{*}_{2}(q_{0}^{2},x)$.

Se $\delta^{*}(q_{0},x)\in F$ vuol dire che $p\in F_{1}$ e $q\in F_{2}$, e questo significa che $x\in L_{1}$ e $x\in L_{2}\implies x\in L_{1}\cap L_{2.}$
**$\Longleftarrow:$**
Se $x\in L_{1}$ e $x\in L_{2}$, avremo $\delta^{*}_{1}(q_{0}^{1},x)\in F_{1}$ e $\delta^{*}_{2}(q_{0}^{2},x)\in F_{2}$. Ma la $\delta^{*}$ è identificata dalla coppia
$$\delta^{*}(q_{0},x)=(\delta^{*}_{1}(q_{0}^{1},x),\delta^{*}_{2}(q_{0}^{2},x))\in F_{1}\times F_{2}= F $$
e quindi $M$ accetta $x.\quad\blacksquare$
##### Complemento

###### Teorema - Chiusura per il complemento
<font color="#000000"><span style="background:#ff4d4f">CHIEDERE A VENTURI</span></font>
##### Concatenazione
###### Teorema - Chiusura per la concatenazione
Dati due linguaggi regolari $L_{1}, L_{2}$ è possibile dimostrare che $L_{1}\circ L_{2}\in REG?$

Dato $x$, devo "capire" come spezzare $x$ in $x_{1}\circ x_{2}=x_{1}x_{2}$ tali che $x_{1}\in L_{1}$ e $x_{2}\in L_{2}.$ Per risolvere questo problema verrà introdotto il concetto di **non-determinismo**.
### Non Determinismo
Finora la computazione è stata deterministica, ovvero se $D$ è un $DFA$ e $D$ legge $a\in\Sigma$ nello stato $q\in Q$, allora $D$ può andare in un unico altro stato $p\in Q.$

Nel caso non deterministico:
- Quando l'automa è in $q$ e legge $a$ può andare in diversi stati: $p_{1},p_{2},...$
- Inoltre sono ammessi $\mathcal{E}-\text{archi}:$ consentono di aprire rami di computazione parallela senza leggere nulla.
- Accettare: Accetto se e solo se esiste almeno un ramo che accetta.
![[lez03_01.drawio.svg|700x527]]
###### Definizione -  Automa a Stati Finiti Non-Deterministico
Un Automa a Stati Finiti Non-Deterministico (**NFA**) è una quintupla $(Q,\Sigma,\delta,q_{0},F)$ dove $q,\Sigma,q_{0},F$ sono uguali a quelli dei DFA, mentre invece:
$$\begin{gathered}\delta:Q\times\Sigma_{\mathcal{E}}\longrightarrow\mathcal{P}\end{gathered}(Q)$$
Dove $\mathcal{P}(Q)$ è l'insieme di tutti i possibili sottoinsiemi di $Q$.

Questa definizione ci dice semplicemente che la funzione di transizione può avere come input anche il simbolo speciale $\mathcal{E}$ che rappresenta le $\mathcal{E}-$transizioni:
$$\begin{gathered}\Sigma_{\mathcal{E}}=\Sigma\cup \{\mathcal{E} \} \end{gathered}$$
L'output della funzione non è un singolo stato, ma un insieme di stati che rappresenta tutte le possibili destinazioni.

Esempio:
![[lez03_02.drawio.svg|700x244]]
Questo è un automa che riconosce se una stringa ha $1$ come terzultimo carattere. Quindi:
$$L=\Big\{x\in\{0,1 \}^{*}: \text{x ha "1" in terzultima posizione}\Big\}$$
Con l'input $x=10110$
![[lez03_03.drawio.svg|700x773]]

Possiamo estendere il concetto di configurazione: Per un **NFA** $N$ la configurazione (lo stato di computazione dell'automa, ovvero lo stato dove si trova + ciò che rimane ancora da leggere) sarà una coppia $(q,x)\in Q\times\Sigma^{*}_{\mathcal{E}}.$ Avremo:
$$(p,ax)\underset{\substack{\text{in relazione}\\ \text{secondo } N\ \text{che}\\ \text{è il NFA fissato}}}{\underbrace{\vdash_{N}}}(q,x)\iff q\in\delta(p,a)\qquad\begin{cases}x\in\Sigma^{*}_{\mathcal{E}}\\ a\in\Sigma_{\mathcal{E}}\\ p,q\in Q \end{cases}$$
$$\begin{gathered}\delta(p,a)\in\mathcal{P}(Q) \end{gathered}$$
Ovvero, se esistono le configurazioni $(p,ax)$ e $(q,x)$ che sono in relazione secondo $N$, $q$ deve poter essere raggiunto dallo stato $p$ attraverso l'input $a$ e la funzione di transizione $\delta(p,a)$.

La funzione di transizione $\delta(p,a)$ restituisce un insieme di stati, quindi il suo codominio è dell'insieme delle parti di tutti gli stati $\mathcal{P}(Q)$ deve avere q 
Con $\mathcal{P}(Q)$ si intende l'insieme delle parti di $Q.$
 
Inoltre $N$ accetta $w\in\Sigma^{*}_{\mathcal{E}}$ se e solo se $\exists q\in F$ tale che $$(q_{0},w)\vdash_{N}^{*}(q,\mathcal{E})$$ dove $\vdash_{N}^{*}$ è la relazione estesa.
In altre parole, la stringa $w$, una volta processato l'automa completamente, lascia l'automa nello stato $q$.
#### NFA e Linguaggi Regolari
L'insieme di tutti i linguaggi riconoscibili da un **DFA** è identificato con $\mathcal{L}(\text{DFA})\equiv REG$.

Possiamo definire anche una classe come $REG$ per gli **NFA**. Ovvero l'insieme di tutti i linguaggi riconosciuti da un NFA:
$$\mathcal{L}(NFA)=\{L:\exists NFA\quad N \ \text{tale che }L(N)=L\}
$$
La parte interessante è che $\mathcal{L}(NFA)$ corrisponde esattamente alla classe $REG$ dei DFA.
###### Teorema $\mathcal{L}(DFA)=REG = \mathcal{L}(NFA).$
La prima uguaglianza è vera per definizione di $REG$ rispetto ai $DFA$. Dimostriamo la seconda.
**Dimostrazione:**
Devo dimostrare che $\mathcal{L}(NFA)\subseteq \mathcal{L}(DFA)$ e $\mathcal{L}(DFA)\subseteq\mathcal{L}(NFA).$

- $\mathcal{L}(DFA)\subseteq \mathcal{L}(NFA):$
Se $L\in \mathcal{L}(DFA)$ vuol dire che $\exists DFA\ D$
 tale che $L(D)=L$, ma essendo che un **DFA** *è anche* un **NFA**, allora $N=D$, è un $NFA$ tale che $L(N)=L.$
- $\mathcal{L}(DFA)\subseteq \mathcal{L}(NFA):$

Se $L\in \mathcal{L}(NFA)$ vuol dire che esiste un **NFA** $N=(Q_{N},\Sigma,\delta_{N},q_{0}^{N},F_{N})$ tale che $L(N)=L.$

Devo quindi costruire un **DFA** $D =(Q_{D},\Sigma,\delta_{0},q_{0}^{D},F_{D})$ tale che $L(D)=L$.
(Che è la stessa idea della dimostrazione di chiusura rispetto all'unione.)

- **Caso semplice:** $\nexists$ $\mathcal{E}-\text{archi}$. 
Se non esistono $\mathcal{E}-$archi, allora avremo:
- $Q_{D}=\mathcal P(Q_{N})$ - Gli stati di $D$ corrispondono all'insieme delle parti degli stati di $N$
- $q_{0}^{D}=\{q_{0}^{N} \}$ - Lo stato iniziale di $D$ è un insieme che contiene lo stato iniziale di $N$ (Perché il suo dominio è appunto l'insieme delle parti)
- $F_{D}=\{R\in Q_{D}:R\cap F_{N}\neq\emptyset \}$. - L'insieme degli stati finali di $D$ corrisponde all'insieme di tutti i sottoinsiemi di stati che contengono almeno uno stato finale di $N$}.
- Sia $R\in Q_{D},\ a\in\Sigma:$
$$\delta_{D}(R,a)=\bigcup_{x\in R}\delta_{N}(r,a)$$
$$\Big(=\{q,\in Q_{N}: q\in\delta_{N}(r,a) \text{ per qualche } r\in R\}.\Big)$$
Di fatto $D$ sta emulando deterministicamente tutti i rami di computazione non-deterministici di $N.$

Caso generale: Ci sono $\mathcal{E}-\text{archi}$. Devo tenere traccia degli sati raggiungibili usando $\mathcal{E}-\text{archi}$.

Sia $R\in Q_{D}$. Definisco:
$E(R)=\{q\in Q_{N}: q$ può essere rggiunto da stati in $R$ attraverso $\ge0$ $\mathcal{E}-\text{archi}\}$. A questo punto: $$\delta_{D}(R,a)=\bigcup_{r\in R}E(\delta_{N}(r,a))$$
Correttezza: come sopra.
Esempio: Dato il seguente $NFA$
<span style="background:#d3f8b6">IMMAGINE NFA</span>

Definire il $DFA$ $D$ tale che $L(D)=L(N)$.
